<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examples | TrussC</title>
    <meta name="description" content="TrussC interactive examples running in WebAssembly. Try them in your browser.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="examples.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <a href="../index.html" class="nav-logo">
                <!-- <span class="logo-text">TrussC</span> -->
                <img src="../assets/images/logo-navigator.svg" alt="TrussC" class="logo-img">
            </a>
            <button class="nav-toggle" aria-label="Open menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html" class="active">Examples</a></li>
                <li><a href="../for-of-users.html">For oF Users</a></li>
                <li><a href="https://gemini.google.com/gem/16aq3ccVPl33j6xSMyE7MWXDjaZvauL0I" target="_blank" rel="noopener">Ask AI</a></li>
                <li><a href="https://github.com/TrussC-org/TrussC/blob/main/docs/GET_STARTED.md" class="nav-cta" target="_blank" rel="noopener">Get Started</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="examples-hero">
        <div class="container">
            <h1 class="examples-hero-title">Examples</h1>
            <p class="examples-hero-description">
                Interactive demos running in your browser via WebAssembly.<br>
                Click any example to try it live.
            </p>
        </div>
    </header>

    <!-- Examples by Category -->
    <section class="section">
        <div class="container">
            <div id="examples-container">
                <div class="loading">Loading examples...</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 TrussC. Released under the <a href="../license.html">MIT License</a>.</p>
            </div>
        </div>
    </footer>

    <script src="../script.js"></script>
    <script>
        const WASM_BASE_URL = 'https://wasm.trussc.org';

        // カテゴリー表示名
        const categoryNames = {
            '3d': '3D',
            'animation': 'Animation',
            'communication': 'Communication',
            'events': 'Events',
            'graphics': 'Graphics',
            'ImGui': 'ImGui',
            'input_output': 'Input / Output',
            'math': 'Math',
            'network': 'Network',
            'node': 'Node',
            'sound': 'Sound',
            'templates': 'Templates',
            'threads': 'Threads',
            'utils': 'Utilities',
            'video': 'Video',
            'windowing': 'Windowing'
        };

        // Addon display names
        const addonNames = {
            'tcxBox2d': 'Box2D Physics',
            'tcxOsc': 'OSC',
            'tcxTls': 'TLS / HTTPS'
        };

        // Generate title from name (e.g., "graphicsExample" -> "Graphics")
        function nameToTitle(name) {
            return name.replace(/Example$/, '').replace(/^example-/, '').replace(/([a-z])([A-Z])/g, '$1 $2');
        }

        async function loadExamples() {
            try {
                const response = await fetch('examples.json');
                if (!response.ok) throw new Error('Failed to load examples.json');
                const data = await response.json();
                renderExamples(data);
            } catch (error) {
                console.error('Error loading examples:', error);
                document.getElementById('examples-container').innerHTML = `
                    <div class="error-message">
                        <p>Failed to load examples. Please try again later.</p>
                    </div>
                `;
            }
        }

        function renderExamples(data) {
            const container = document.getElementById('examples-container');
            const isWebSupported = (example) => example.webSupported !== false;

            // Card generator for examples
            const renderCard = (example, type, group) => {
                const title = nameToTitle(example.name);
                const thumbPath = type === 'examples'
                    ? `thumbs/examples/${group}/${example.name}.png`
                    : `thumbs/addons/${group}/${example.name}.png`;
                const thumb = `${WASM_BASE_URL}/${thumbPath}`;
                const playerUrl = `player.html?type=${type}&group=${group}&name=${example.name}`;
                return `
                <a href="${playerUrl}" class="example-card${isWebSupported(example) ? '' : ' not-web-supported'}">
                    <div class="example-thumb">
                        <img src="${thumb}" alt="${title}" loading="lazy">
                        ${isWebSupported(example) ? '' : '<div class="example-unsupported-overlay">Native only</div>'}
                    </div>
                    <div class="example-info">
                        <h3 class="example-title">${title}</h3>
                    </div>
                </a>
            `;
            };

            let html = '';

            // Render examples by category (uses JSON key order)
            Object.keys(data.examples).forEach(cat => {
                const catData = data.examples[cat];
                if (catData && catData.visible !== false && catData.items && catData.items.length > 0) {
                    const visibleItems = catData.items.filter(e => e.visible !== false);
                    if (visibleItems.length > 0) {
                        html += `
                            <div class="category-section">
                                <h2 class="category-title">${categoryNames[cat] || cat}</h2>
                                <div class="examples-grid">
                                    ${visibleItems.map(e => renderCard(e, 'examples', cat)).join('')}
                                </div>
                            </div>
                        `;
                    }
                }
            });

            // Render addons
            if (data.addons) {
                for (const [addon, addonData] of Object.entries(data.addons)) {
                    if (addonData.visible !== false && addonData.items && addonData.items.length > 0) {
                        const visibleItems = addonData.items.filter(e => e.visible !== false);
                        if (visibleItems.length > 0) {
                            html += `
                                <div class="category-section addon-section">
                                    <h2 class="category-title">${addonNames[addon] || addon}</h2>
                                    <div class="examples-grid">
                                        ${visibleItems.map(e => renderCard(e, 'addons', addon)).join('')}
                                    </div>
                                </div>
                            `;
                        }
                    }
                }
            }

            container.innerHTML = html;
        }

        loadExamples();
    </script>
</body>
</html>
